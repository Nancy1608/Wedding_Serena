<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>
  <meta charset="UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wedding Guest List</title>


  <style>
    body {
        font-family: 'Segoe UI', sans-serif;
        background-color: #fffaf5;
        margin: 0;
        padding: 0;
        color: #4b3832;
    }
    header {
        background: linear-gradient(to right, #d4af37, #f8e1d4);
        padding: 15px;
        text-align: center;
        font-size: 1.4em;
        font-weight: bold;
        color: white;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        padding: 10px;
        justify-content: center;
        background-color: #fdf6f0;
    }
    input[type="file"], select, button, input[type="text"] {
        padding: 8px;
        border-radius: 8px;
        border: 1px solid #d4af37;
        font-size: 1em;
    }
    button {
        background-color: #d4af37;
        color: white;
        border: none;
        cursor: pointer;
    }
    button:hover {
        background-color: #b8902f;
    }
    .table-group {
        background-color: white;
        margin: 15px;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        overflow: hidden;
    }
    .table-header {
        background-color: #f8e1d4;
        padding: 10px;
        font-weight: bold;
        font-size: 1.2em;
        border-bottom: 1px solid #f3d1c1;
    }
    .guest {
        display: flex;
        justify-content: space-between;
        padding: 10px;
        border-bottom: 1px solid #f9e8de;
    }
    .guest:last-child {
        border-bottom: none;
    }
    .status-btn {
        padding: 5px 10px;
        border-radius: 6px;
        border: none;
        font-size: 0.9em;
        cursor: pointer;
    }
    .RSVP {
        background-color: #f8e1d4;
        color: #4b3832;
    }
    .Arrived {
        background-color: #d4af37;
        color: white;
    }
    .counters {
        text-align: center;
        padding: 10px;
        font-size: 1.1em;
        background-color: #fff8f0;
        border-bottom: 1px solid #f3d1c1;
    }
  </style>
</head><body>

<header>Wedding Guest List</header>
<div class="counters">
    RSVP: <span id="rsvpCount">0</span> | Arrived: <span id="arrivedCount">0</span>
</div>


<div class="controls">
    <input id="fileInput" accept=".xlsx, .xls" type="file">
    <input id="searchInput" placeholder="Search..." type="text">
    <button onclick="searchGuests()">Go</button>
    <select id="statusFilter" onchange="renderGuests()">
        <option value="All">All</option>
        <option value="RSVP">RSVP</option>
        <option value="Arrived">Arrived</option>
    </select>
    <button onclick="resetAll()">Reset All to RSVP</button>
</div>




<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
let guests = [];

document.getElementById('fileInput').addEventListener('change', handleFile, false);

function handleFile(e) {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = function(event) {
        const data = new Uint8Array(event.target.result);
        const workbook = XLSX.read(data, {type: 'array'});
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        const rows = XLSX.utils.sheet_to_json(sheet, {header: 1});
        guests = rows.map(row => ({
            table: row[0],
            pax: row[1],
            name: row[2],
            status: 'RSVP'
        }));
        renderGuests();
    };
    reader.readAsArrayBuffer(file);
}

function renderGuests(filterStatus = document.getElementById('statusFilter').value, searchTerm = '') {
    const container = document.getElementById('guestList');
    container.innerHTML = '';
    const grouped = {};

    guests.forEach(g => {
        if ((filterStatus === 'All' || g.status === filterStatus) &&
            (g.name.toLowerCase().includes(searchTerm) || g.table.toString().includes(searchTerm))) {
            if (!grouped[g.table]) grouped[g.table] = [];
            grouped[g.table].push(g);
        }
    });

    Object.keys(grouped).sort((a,b) => a - b).forEach(tableNum => {
        const groupDiv = document.createElement('div');
        groupDiv.className = 'table-group';
        const header = document.createElement('div');
        header.className = 'table-header';
        header.textContent = `Table ${tableNum}`;
        groupDiv.appendChild(header);

        grouped[tableNum].forEach((guest, index) => {
            const guestDiv = document.createElement('div');
            guestDiv.className = 'guest';
            guestDiv.innerHTML = `<span>${guest.name} (${guest.pax})</span>`;
            const btn = document.createElement('button');
            btn.textContent = guest.status;
            btn.className = `status-btn ${guest.status}`;
            btn.onclick = () => toggleStatus(guest);
            guestDiv.appendChild(btn);
            groupDiv.appendChild(guestDiv);
        });

        container.appendChild(groupDiv);
    });

    updateCounters();
}

function toggleStatus(guest) {
    guest.status = guest.status === 'RSVP' ? 'Arrived' : 'RSVP';
    renderGuests();
}

function resetAll() {
    guests.forEach(g => g.status = 'RSVP');
    renderGuests();
}

function searchGuests() {
    const term = document.getElementById('searchInput').value.toLowerCase();
    renderGuests(document.getElementById('statusFilter').value, term);
    document.getElementById('searchInput').value = '';
}

function updateCounters() {
    const rsvpCount = guests.filter(g => g.status === 'RSVP').length;
    const arrivedCount = guests.filter(g => g.status === 'Arrived').length;
    document.getElementById('rsvpCount').textContent = rsvpCount;
    document.getElementById('arrivedCount').textContent = arrivedCount;
}
</script>

</body></html>