<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Wedding Guest List</title>
<style>
  body { font-family: Arial, sans-serif; background: #fff; margin: 0; padding: 0; }
  .container { padding: 10px; max-width: 1000px; margin: auto; }
  .filters { position: sticky; top: 0; background: #fff; padding: 10px 0; z-index: 100; display: flex; gap: 10px; }
  button { padding: 8px 12px; border: none; cursor: pointer; border-radius: 4px; }
  .arrived-btn { background: #4CAF50; color: white; }
  .pending-btn { background: #FFC107; color: black; }
  .clear-btn { background: #ccc; border-radius: 50%; padding: 0 6px; cursor: pointer; }
  table { border-collapse: collapse; width: 100%; }
  th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
  th { background-color: #f2f2f2; }
  .card { border: 1px solid #ddd; border-radius: 8px; padding: 10px; margin-bottom: 10px; }
  @media (max-width: 768px) {
    table { display: none; }
    .card { display: block; }
  }
  @media (min-width: 769px) {
    .card { display: none; }
  }
</style>
</head>
<body>
<div class="container">
  <div class="filters">
    <button onclick="filterGuests('all')">All</button>
    <button onclick="filterGuests('arrived')">Arrived</button>
    <button onclick="filterGuests('pending')">Pending</button>
    <input type="text" id="search" placeholder="Search..." oninput="searchGuests()" />
    <span class="clear-btn" onclick="clearSearch()">×</span>
    <button onclick="revertAll()">Revert All</button>
    <div id="totalPax" style="margin-left:auto; font-weight:bold;"></div>
  </div>
  <table id="guestTable">
    <thead>
      <tr><th>Table No</th><th>Guest Name</th><th>Pax</th><th>Status</th></tr>
    </thead>
    <tbody></tbody>
  </table>
  <div id="guestCards"></div>
</div>
<script>
  let guests = [[2, 2, 'Kian Mun & Daughter'], [2, 1, 'Amy'], [2, 3, 'Benny & Family'], [2, 4, 'Victor & Family'], [3, 3, 'Lay Weng & Family'], [3, 6, 'Carmen & Family'], [3, 1, 'Nancy'], [4, 4, 'Shirley & Family'], [4, 1, 'Annie'], [4, 1, 'Ruby'], [4, 2, 'Amy Tiew & Ah Ngoh'], [4, 2, 'Mr & Mrs Sunny Tiew'], [8, 2, 'Mr & Mrs Soon Chin Hoon'], [8, 2, 'Ong Ting Ting & Spouse'], [8, 2, 'Mr & Mrs Jesse Jee'], [8, 2, 'Mr & Mrs Lee Peng Koon'], [8, 2, 'Mr & Mrs Loh Hoi Yew'], [9, 10, 'Seah Kiat Seng & Family'], [10, 1, 'Ms Soo Kah Huey'], [10, 2, 'Dato’ & Datin Soo Kah Eng'], [10, 2, 'Dato’ & Datin Lew Wai Koung'], [10, 1, 'Datin Toh Bee Huan'], [10, 2, 'Mr & Mrs Soo Hock Chuan'], [10, 1, 'Mdm Lau Yoke Eng'], [10, 1, 'Mdm Isabelle Fam'], [14, 2, 'Ming Ming & Spouse'], [14, 2, 'Lee Kah Yee & Spouse'], [14, 1, 'Ming Ming’s Aunty'], [14, 1, 'Mrs Lim Tua Lek'], [14, 3, 'Nicole Yap & Family'], [15, 2, 'Mr & Mrs Chan (Joo Heong)'], [15, 1, 'Ricky Chan'], [15, 2, 'Liew Li Fong & Spouse'], [15, 2, 'Tan Ai Tiang & Spouse'], [15, 1, 'Kevin Lau'], [15, 2, 'Mr & Mrs Wong Yok Heng'], [16, 2, 'Mr & Mrs Sunny Phang'], [16, 1, 'Ms Eng Hui Mun'], [16, 1, 'Ms Tan Yoke Lan'], [16, 2, 'Mr & Mrs Ng Kim Siah'], [16, 2, 'Mr & Mrs Yap Meow Sing'], [16, 2, 'Mr & Mrs Lim Tow Poe'], [20, 4, "Boon's Friends"], [20, 6, "Serena's Friends"], [21, 1, 'Gurdeu'], [21, 4, 'Jasvin, Annish & Family'], [21, 3, 'Sukhvinder & Family'], [21, 2, 'Dato’ & Datin Jesbil'], [22, 2, 'Mr & Mrs Loh Weng Cheong'], [22, 2, 'Mr & Mrs Goh Keat Hoe'], [22, 2, 'Mr & Mrs Eric Woh Pei Su'], [22, 2, 'Mr & Mrs Francis Wong'], [22, 1, 'Lim Hong Guan'], [22, 1, 'Ang Sing Hai']];
  let statusMap = JSON.parse(localStorage.getItem('guestStatus')) || {}
  let currentFilter = 'all';

  function saveStatus() {
    localStorage.setItem('guestStatus', JSON.stringify(statusMap));
  }

  function updateDisplay() {
    const tbody = document.querySelector('#guestTable tbody');
    const cardsContainer = document.getElementById('guestCards');
    tbody.innerHTML = '';
    cardsContainer.innerHTML = '';
    let searchTerm = document.getElementById('search').value.toLowerCase();

    let filtered = guests.filter(g => {
      let status = statusMap[g[2]] || 'pending';
      let match = g[1].toString().includes(searchTerm) || g[2].toLowerCase().includes(searchTerm);
      let passFilter = (currentFilter === 'all') || (currentFilter === status);
      return match && passFilter;
    });

    let totalPax = 0;

    filtered.forEach(g => {
      let tableNo = g[0], pax = g[1], name = g[2];
      let status = statusMap[name] || 'pending';
      totalPax += pax;
      let statusBtn = `<button class="${status==='arrived'?'arrived-btn':'pending-btn'}" onclick="toggleStatus('${name}')">${status==='arrived'?'Arrived':'Pending'}</button>`;
      tbody.innerHTML += `<tr><td>${tableNo}</td><td>${name}</td><td>${pax}</td><td>${statusBtn}</td></tr>`;
      cardsContainer.innerHTML += `<div class='card'><strong>Table:</strong> ${tableNo}<br><strong>Name:</strong> ${name}<br><strong>Pax:</strong> ${pax}<br>${statusBtn}</div>`;
    });

    document.getElementById('totalPax').innerText = 'Total Pax: ' + totalPax;
  }

  function filterGuests(f) {
    currentFilter = f;
    updateDisplay();
  }

  function toggleStatus(name) {
    statusMap[name] = statusMap[name] === 'arrived' ? 'pending' : 'arrived';
    saveStatus();
    updateDisplay();
  }

  function revertAll() {
    statusMap = {}
    saveStatus();
    updateDisplay();
  }

  function searchGuests() {
    updateDisplay();
  }

  function clearSearch() {
    document.getElementById('search').value = '';
    updateDisplay();
  }

  updateDisplay();
</script>
</body>
</html>
